<!DOCTYPE html>
<html lang="en">
<head>
<script type="module">
document.write("<pre>")
import { init, step, getMemory } from "./build/debug.js"
const program = ">>>>>+[-->-[>>+>-----<<]<--<---]>-.>>>+.>>..+++[.>]<<<<.+++.------.<<-.>>>>+."
const input = new TextEncoder().encode("jdsb\n")
let ic = 0
init(program, 1000)
let t = Date.now()
let r = step(0, 0)
let [pc, ot, ov] = r
while (ot >= 0) {
  if (Date.now() - t > 10000) break
  let it = 0, iv = 0
  if (ot === 0x2c) { it = 0x2c, iv = ic < input.length ? input[ic++] : ov }
  else if (ot === 0x2e) document.write(String.fromCharCode(ov))
  //console.log(pc, ot, ov, it, iv)
  ;[pc, ot, ov] = r = step(it, iv)
}
console.log(pc, ot, ov)
    console.log("halt", getMemory())
document.write("\n\n\n" + (Date.now() - t) + "</pre>")
</script>
</head>
<body></body>
</html>
